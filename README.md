# LiWi-HAR

These are the code and data for the paper: [LiWi-HAR: Human Activity Recognition using Lightweight Programmable WiFi Chips].

LiWi-HAR is to propose a new human activity segmentation and recognition scheme based on WiFi Channel State Information (CSI).


# Citation

@ARTICLE{LiWi-HAR2023,  
&nbsp; &nbsp; author={Weixi Liang and Rongshan Tang and Sihan Jaing and Ruqi Wang and Yubin Zhao and Cheng-Zhong Xu and Xudong Long and Zhuolong Chen and Xiaofan Li},  
&nbsp; &nbsp; title={LiWi-HAR: Human Activity Recognition using Lightweight Programmable WiFi Chips},  
&nbsp; &nbsp; year={2023},  
}


# DataSet

The data that we extract from raw CSI data for our experiments can be downloaded from Baidu Netdisk:

Raw CSI data we collected can be downloaded via Baidu. Note that there is need to download the Data_RawCSIDat and Data_Continuous for running our experiments.

All raw CSI data: DATA
Baidu Netdisk：https://pan.baidu.com/s/1bUsv9rPpYuu1xekdwqYczA?(Password：0827)

Data of Raw CSI: Data_RawCSIDat  
Baidu Netdisk: https://pan.baidu.com/s/1ZUkZlyHI-oHvDNWWErVn5Q?(Password: aidu)

Data of Raw Continuous CSI: Data_Continuous  
Baidu: https://pan.baidu.com/s/1NmU649cHy10f9ej6zUAwdQ?(Password:8ts1)


# Requirement
Python3.7  
pytorch 
Matlab R2020b
The codes are tested under window10 and it should be ok for ESP Espressif. 


# Folder descriptions:

*01_preprocess:*
This is used to extract amplitudes from raw CSI *.dat files, and save as *.mat files, aiming at generating files in the folder Data_CsiAmplitude. 

*02_segment:*
This is used to discreize continuous CSI data into bins for segmentation which will be used in the activity segmentation algorithm. 

*03_extraction:*
This is used to extract the features from the CSI data. 

*04_identify:*
This is for training the activities recognition model, and inferring the state labels of CSI data bins generated by Data_CsiFeature.

*05_optimization:*
This is used to optimize the activities recognition model by pre-training the network weights and thresholds.

![Figure](https://github.com/liangwxsysu/LiWi-HAR/blob/master/Visual_Activities_Segementaiotn.jpg)
<p align="center">Figure 1. Visual Inspection about start and end points of activities. </p>


# Motivation for LiWi-HAR

![Figure](https://github.com/liangwxsysu/LiWi-HAR/blob/master/Visual_Segmentaion_Threshold.jpg)
<p align="center">Figure 2. Performance of threshold-based activity segmentation methods for mixed activities. </p>

# DeepSeg Overview

![Figure](https://github.com/liangwxsysu/LiWi-HAR/blob/master/LiWiHAR_framework.jpg)
<p align="center">Figure 3. DeepSeg Framework. </p>




